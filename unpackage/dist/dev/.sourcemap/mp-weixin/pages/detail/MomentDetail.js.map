{"version":3,"sources":["uni-app:///main.js","webpack:///C:/Users/菜里小青虫/Desktop/coderhub/pages/detail/MomentDetail.vue?87b0","webpack:///C:/Users/菜里小青虫/Desktop/coderhub/pages/detail/MomentDetail.vue?c60d","webpack:///C:/Users/菜里小青虫/Desktop/coderhub/pages/detail/MomentDetail.vue?e346","webpack:///C:/Users/菜里小青虫/Desktop/coderhub/pages/detail/MomentDetail.vue?4c25","uni-app:///pages/detail/MomentDetail.vue"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page"],"mappings":"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","file":"pages/detail/MomentDetail.js","sourcesContent":["import 'uni-pages';wx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './pages/detail/MomentDetail.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./MomentDetail.vue?vue&type=template&id=4a2bf126&scoped=true&\"\nvar renderjs\nimport script from \"./MomentDetail.vue?vue&type=script&lang=js&\"\nexport * from \"./MomentDetail.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\runtime\\\\componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"4a2bf126\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/detail/MomentDetail.vue\"\nexport default component.exports","export * from \"-!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\templateLoader.js??vue-loader-options!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--16-0!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\template.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-uni-app-loader\\\\page-meta.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./MomentDetail.vue?vue&type=template&id=4a2bf126&scoped=true&\"","var components\ntry {\n  components = {\n    uniNavBar: function() {\n      return import(\n        /* webpackChunkName: \"uni_modules/uni-nav-bar/components/uni-nav-bar/uni-nav-bar\" */ \"@/uni_modules/uni-nav-bar/components/uni-nav-bar/uni-nav-bar.vue\"\n      )\n    }\n  }\n} catch (e) {\n  if (\n    e.message.indexOf(\"Cannot find module\") !== -1 &&\n    e.message.indexOf(\".vue\") !== -1\n  ) {\n    console.error(e.message)\n    console.error(\"1. 排查组件名称拼写是否正确\")\n    console.error(\n      \"2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom\"\n    )\n    console.error(\n      \"3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件\"\n    )\n  } else {\n    throw e\n  }\n}\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./MomentDetail.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./MomentDetail.vue?vue&type=script&lang=js&\"","<template>\r\n\t<view class=\"\">\r\n\t\t<uni-nav-bar statusBar=\"true\" :border=\"false\" left-icon=\"left\" @clickLeft=\"back()\"></uni-nav-bar>\r\n\t\t\r\n\t\t<scroll-view :style=\"{'height': bodyHeight + 'px'}\" \r\n\t\t\tscroll-y \r\n\t\t\trefresher-enabled\r\n\t\t\t:refresher-threshold=\"80\"\r\n\t\t\t@refresherrefresh=\"xialashuaxin\" \r\n\t\t\t:refresher-triggered=\"isXialashuaxin\"\r\n\t\t\tlower-threshold=\"100\"\r\n\t\t\t@scrolltolower=\"shanglajiazai\"\r\n\t\t>\r\n\t\t\t<Moment :moment=\"moment\" @toolbar=\"toolbar\"></Moment>\r\n\t\t\t<CommentList :commentList=\"commentList\" @clickContent=\"clickContent\" @clickReply=\"clickReply\" @like=\"like\"></CommentList>\r\n\t\t</scroll-view>\r\n\t\t\r\n\t\t<KeyInput :placeholder=\"placeholder\" @pub=\"pub\" ref=\"input\" @blur=\"blur\"></KeyInput>\r\n\t\t\r\n\t\t<Popup ref=\"popup\" \r\n\t\t\t:comment=\"commentList[clickCommentIndex]\" \r\n\t\t\t:replyList=\"replyList\"\r\n\t\t\t@pubReply=\"pubReply\"\r\n\t\t\t@like=\"popupLike\"\r\n\t\t\t@likeItem=\"likeItem\"\r\n\t\t>\r\n\t\t</Popup>\r\n\t</view>\n</template>\n\n<script>\r\n\timport { mapGetters } from 'vuex'\r\n\t\r\n\timport { request } from '@/network/request.js'\r\n\t\r\n\timport Moment from '@/components/detail/Moment.vue'\r\n\timport CommentList from '@/components/detail/CommentList.vue'\r\n\timport KeyInput from '@/components/detail/KeyInput.vue'\r\n\timport Popup from '@/components/detail/Popup.vue'\r\n\t\r\n\texport default {\r\n\t\tname: 'MomentDetail',\r\n\t\tcomponents: {\r\n\t\t\tMoment,\r\n\t\t\tCommentList,\r\n\t\t\tKeyInput,\r\n\t\t\tPopup\r\n\t\t},\r\n\t\tcomputed: {\r\n\t\t\t...mapGetters([\r\n\t\t\t\t'userInfo'\r\n\t\t\t])\r\n\t\t},\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tmoment: {},\r\n\t\t\t\tcommentList: [],\r\n\t\t\t\tbodyHeight: 0,\r\n\t\t\t\tplaceholder: '发表一条友善的评论',\r\n\t\t\t\tclickCommentIndex: null,\r\n\t\t\t\treplyList: [],\r\n\t\t\t\tisXialashuaxin: false,\r\n\t\t\t\tpage: 0,\r\n\t\t\t\tisPub: false\r\n\t\t\t}\r\n\t\t},\r\n\t\tonLoad: function (option) {\r\n\t\t\tthis.getMomentDetail(option.id)\r\n\t\t\tthis.getComment(option.id)\r\n\t\t\t\r\n\t\t\tconst res = uni.getSystemInfoSync()\r\n\t\t\tthis.bodyHeight = res.windowHeight - res.statusBarHeight - 44 - 60\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tback() {\r\n\t\t\t\tuni.navigateBack()\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 请求动态详情\r\n\t\t\tasync getMomentDetail(id) {\r\n\t\t\t\tconst res = await request({\r\n\t\t\t\t\turl: `/moment/${id}`\r\n\t\t\t\t})\r\n\t\t\t\t\r\n\t\t\t\tthis.moment = res.data\r\n\t\t\t\tif(res.statusCode != 200) return uni.showToast({title: res.data, icon: \"error\"})\r\n\t\t\t\tif(!res.data.momentId) return uni.showToast({title: \"动态已被删除！\", icon: \"error\"})\r\n\t\t\t\tthis.moment = res.data\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 请求评论\r\n\t\t\tasync getComment(id) {\r\n\t\t\t\tconst offset = this.page * 10\r\n\t\t\t\tconst limit = (this.page + 1) * 10\r\n\t\t\t\tconst res = await request({\r\n\t\t\t\t\turl: '/comment',\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\tmomentId: id,\r\n\t\t\t\t\t\torder: 0,\r\n\t\t\t\t\t\toffset,\r\n\t\t\t\t\t\tlimit,\r\n\t\t\t\t\t\tuserId: this.userInfo.id || ''\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\tif(res.statusCode != 200) return uni.showToast({title: \"评论获取失败╰(*°▽°*)╯\", icon: \"error\"})\r\n\t\t\t\t\r\n\t\t\t\tthis.page += 1\r\n\t\t\t\tthis.commentList.push(...res.data)\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 请求回复\r\n\t\t\tasync getReplyList(id) {\r\n\t\t\t\tconst res = await request({\r\n\t\t\t\t\turl: '/comment',\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\tcommentId: id,\r\n\t\t\t\t\t\tuserId: this.userInfo.id || ''\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t})\r\n\t\t\t\tif(res.statusCode != 200) return uni.showToast({title: \"回复获取失败╰(*°▽°*)╯\", icon: \"error\"})\r\n\r\n\t\t\t\tthis.replyList = res.data\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 点击评论\r\n\t\t\tclickContent(index) {\r\n\t\t\t\tthis.clickCommentIndex = index\r\n\t\t\t\tthis.placeholder = `回复 ${this.commentList[index].user.nickname}：`\r\n\t\t\t\tthis.$refs.input.isFocus = true\r\n\t\t\t\tthis.isPub = true\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 点击相关回复\r\n\t\t\tclickReply(index) {\r\n\t\t\t\tthis.$refs.popup.popupOpen()\r\n\t\t\t\tthis.clickCommentIndex = index\r\n\t\t\t\tthis.getReplyList(this.commentList[this.clickCommentIndex].id)\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 二级发表的重复代码\r\n\t\t\tasync pubReplyRequest(comment, value) {\r\n\t\t\t\tconst res = await request({\r\n\t\t\t\t\turl: `/comment/${this.commentList[this.clickCommentIndex].id}`,\r\n\t\t\t\t\tmethod: 'POST',\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\t\"content\": `回复 ${comment.user.nickname}：${value}`,\r\n\t\t\t\t\t\t\"momentId\": this.moment.momentId\r\n\t\t\t\t\t}\r\n\t\t\t\t}, true)\r\n\t\t\t\tif(res.statusCode != 200) return uni.showToast({title: res.data, icon: \"none\"})\r\n\t\t\t\t\r\n\t\t\t\t// KeyInput\r\n\t\t\t\tuni.$emit('pubSuccess')\r\n\t\t\t\tthis.commentList[this.clickCommentIndex].child_count += 1\r\n\t\t\t\t\r\n\t\t\t\tconst newComment = await request({\r\n\t\t\t\t\turl: '/comment',\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\tid: this.userInfo.id,\r\n\t\t\t\t\t\toffset: 0,\r\n\t\t\t\t\t\tlimit: 1\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\tthis.replyList.unshift(newComment.data[0])\r\n\t\t\t\t\r\n\t\t\t\tuni.showToast({title: res.data, icon: \"none\"})\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 点击发表\r\n\t\t\tasync pub(value) {\r\n\t\t\t\tthis.isPub = true\r\n\t\t\t\tif(value == \" \") return uni.showToast({title: \"评论不能为空\", icon: \"error\"})\r\n\t\t\t\tif(this.clickCommentIndex == null) {  // 对动态发表评论\r\n\t\t\t\t\tconst res = await request({\r\n\t\t\t\t\t\turl: '/comment',\r\n\t\t\t\t\t\tmethod: 'POST',\r\n\t\t\t\t\t\tdata: {\r\n\t\t\t\t\t\t\t\"content\": value,\r\n\t\t\t\t\t\t\t\"momentId\": this.moment.momentId\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, true)\r\n\t\t\t\t\t\r\n\t\t\t\t\tif(res.statusCode != 200) return uni.showToast({title: res.data, icon: \"none\"})\r\n\t\t\t\t\t// KeyInput\r\n\t\t\t\t\tuni.$emit('pubSuccess')\r\n\t\t\t\t\t\r\n\t\t\t\t\tconst newComment = await request({\r\n\t\t\t\t\t\turl: '/comment',\r\n\t\t\t\t\t\tdata: {\r\n\t\t\t\t\t\t\tid: this.userInfo.id,\r\n\t\t\t\t\t\t\toffset: 0,\r\n\t\t\t\t\t\t\tlimit: 1\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t\tthis.commentList.unshift(newComment.data[0])\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: res.data,\r\n\t\t\t\t\t\ticon: \"none\"\r\n\t\t\t\t\t})\r\n\t\t\t\t}else {  // 对动态的评论发表回复\r\n\t\t\t\t\tawait this.pubReplyRequest(this.commentList[this.clickCommentIndex], value)\r\n\t\t\t\t}\r\n\t\t\t\tthis.isPub = false\r\n\t\t\t\tthis.placeholder = '发表一条友善的评论'\r\n\t\t\t\tthis.clickCommentIndex = null\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// popup内点击发表\r\n\t\t\tpubReply({value, index}) {\r\n\t\t\t\tif(index == null) {\r\n\t\t\t\t\tthis.pubReplyRequest(this.commentList[this.clickCommentIndex], value)\r\n\t\t\t\t}else {\r\n\t\t\t\t\tthis.pubReplyRequest(this.replyList[index], value)\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 点赞的重复代码\r\n\t\t\tasync likeCode(index, commentOrReplyList) {\r\n\t\t\t\tconst res = await request({\r\n\t\t\t\t\turl: `/comment/${this[commentOrReplyList][index].id}/like`,\r\n\t\t\t\t\tmethod: 'POST'\r\n\t\t\t\t}, true)\r\n\t\t\t\t\r\n\t\t\t\tif(res.statusCode != 200) return uni.showToast({title: res.data, icon: \"none\"})\r\n\t\t\t\t\r\n\t\t\t\tthis[commentOrReplyList][index].isAgree = !this[commentOrReplyList][index].isAgree\r\n\t\t\t\tres.data === '点赞成功' ? ++this[commentOrReplyList][index].agree : --this[commentOrReplyList][index].agree\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: res.data,\r\n\t\t\t\t\ticon: \"none\"\r\n\t\t\t\t})\r\n\t\t\t\t\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 评论点赞\r\n\t\t\tlike(index) {\r\n\t\t\t\tthis.likeCode(index, 'commentList')\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// popup内给评论点赞\r\n\t\t\tpopupLike() {\r\n\t\t\t\tthis.likeCode(this.clickCommentIndex, 'commentList')\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// popup内给回复点赞\r\n\t\t\tlikeItem(index) {\r\n\t\t\t\tthis.likeCode(index, 'replyList')\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 下拉刷新\r\n\t\t\tasync xialashuaxin() {\r\n\t\t\t\tthis.isXialashuaxin = true\r\n\t\t\t\t\r\n\t\t\t\tawait this.getMomentDetail(this.moment.momentId)\r\n\r\n\t\t\t\tif(this.moment.momentId) {\r\n\t\t\t\t\tthis.page = 0\r\n\t\t\t\t\tthis.commentList = []\r\n\t\t\t\t\tawait this.getComment(this.moment.momentId)\r\n\t\t\t\t\tuni.showToast({title: '刷新成功', icon: 'none'})\r\n\t\t\t\t}else {\r\n\t\t\t\t\tuni.showToast({title: \"动态已被删除！\", icon: \"error\"})\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tthis.isXialashuaxin = false\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 上拉加载\r\n\t\t\tshanglajiazai() {\r\n\t\t\t\tthis.getComment(this.moment.momentId)\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 失去焦点\r\n\t\t\tblur() {\r\n\t\t\t\tthis.isPub = false\r\n\t\t\t\tsetTimeout(() =>{\r\n\t\t\t\t\tif(!this.isPub) {\r\n\t\t\t\t\t\tthis.placeholder = '发表一条友善的评论'\r\n\t\t\t\t\t\tthis.clickCommentIndex = null\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 工具栏（三个点）\r\n\t\t\ttoolbar(id) {\r\n\t\t\t\tuni.showActionSheet({\r\n\t\t\t\t\titemList: ['删除'],\r\n\t\t\t\t\tsuccess: async (i) => {\r\n\t\t\t\t\t\tconst res = await request({\r\n\t\t\t\t\t\t\turl: `/moment/${id}`,\r\n\t\t\t\t\t\t\tmethod: 'DELETE'\r\n\t\t\t\t\t\t}, true)\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tif(res.statusCode != 200) return uni.showToast({title: res.data, icon: \"none\"})\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: '删除成功'\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t}\r\n\t}\n</script>\n\n<style scoped>\n</style>\n"],"sourceRoot":""}